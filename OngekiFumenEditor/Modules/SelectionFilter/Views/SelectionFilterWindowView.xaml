<Window x:Class="OngekiFumenEditor.Modules.FumenEditorSelectingObjectViewer.Views.SelectionFilterWindowView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:cal="http://caliburnmicro.com"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:local="clr-namespace:OngekiFumenEditor.Modules.FumenEditorSelectingObjectViewer.Views"
        xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
        xmlns:viewModels="clr-namespace:OngekiFumenEditor.Modules.SelectionFilter.ViewModels"
        xmlns:ongekiObjects="clr-namespace:OngekiFumenEditor.Base.OngekiObjects"
        xmlns:selectionFilter="clr-namespace:OngekiFumenEditor.Modules.SelectionFilter"
        mc:Ignorable="d"
        ShowInTaskbar="False"
        ShowActivated="True"
        SizeToContent="WidthAndHeight"
        Padding="3"
        ResizeMode="NoResize"
        d:DataContext="{d:DesignInstance IsDesignTimeCreatable=True, Type=viewModels:SelectionFilterViewModel}">
    <Window.Resources>
        <DataTemplate DataType="{x:Type viewModels:FilterObjectTypesItem}">
            <TextBlock Text="{Binding Text}" />
        </DataTemplate>

        <Style TargetType="CheckBox">
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
        </Style>
        <Style TargetType="RadioButton">
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
            <Setter Property="Margin" Value="4 0"></Setter>
        </Style>


        <viewModels:ParamValueToBoolConverter x:Key="ParamValueToBoolConverter" />

        <DataTemplate x:Key="ItemCheckListBoxTemplate">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding Display}" />
            </StackPanel>
        </DataTemplate>

    </Window.Resources>

    <Window.DataContext>
        <viewModels:SelectionFilterViewModel />
    </Window.DataContext>

    <StackPanel Orientation="Vertical" Height="Auto">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <Label Grid.Column="0">Object type</Label>
            <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Stretch">
                <Button cal:Message.Attach="FilterObjectTypesSelectAll()">Select all</Button>
                <Button cal:Message.Attach="FilterObjectTypesReset()">Reset</Button>
            </StackPanel>
        </Grid>
        <ItemsControl ItemsSource="{Binding FilterCategories}" x:Name="ObjectTypesCheckListBoxes">
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <StackPanel Orientation="Horizontal" />
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <xctk:CheckListBox ItemsSource="{Binding Items}"
                                       HorizontalContentAlignment="Stretch"
                                       Height="Auto"
                                       IsSelectAllActive="True"
                                       ItemTemplate="{StaticResource ItemCheckListBoxTemplate}"
                                       SelectedMemberPath="IsSelected"
                                       SelectAllContent="{Binding CategoryNameDisplay}"
                                       Loaded="FixFilterTypesAllSelect" />
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>

        <Label>Options</Label>

        <TabControl>
            <TabItem Header="General">
                <StackPanel Orientation="Vertical">
                    <StackPanel Orientation="Horizontal" Margin="5 5">
                        <Label>Tag</Label>
                        <xctk:WatermarkTextBox Width="100" Watermark="&lt;Any&gt;"
                                               Text="{Binding FilterOptions.TagFilter, Mode=TwoWay}" />
                        <CheckBox Content="Regex" IsChecked="{Binding FilterOptions.IsTagFilterRegex, Mode=TwoWay}" />
                    </StackPanel>
                </StackPanel>
            </TabItem>

            <TabItem Header="Lanes">
                <StackPanel Orientation="Vertical">
                    <StackPanel Orientation="Horizontal" Margin="5">
                        <Label Content="Node type" />
                        <RadioButton GroupName="LaneNodeTypeOptions"
                                     Content="Any"
                                     IsChecked="{Binding FilterOptions.NodeTypeFilteringMode, Converter={StaticResource ParamValueToBoolConverter}, ConverterParameter={x:Static selectionFilter:LinePointTypeFilteringMode.Any}, Mode=TwoWay}" />
                        <RadioButton GroupName="LaneNodeTypeOptions"
                                     Content="Start"
                                     IsChecked="{Binding FilterOptions.NodeTypeFilteringMode, Converter={StaticResource ParamValueToBoolConverter}, ConverterParameter={x:Static selectionFilter:LinePointTypeFilteringMode.Head}, Mode=TwoWay}" />
                        <RadioButton GroupName="LaneNodeTypeOptions"
                                     Content="Next"
                                     IsChecked="{Binding FilterOptions.NodeTypeFilteringMode, Converter={StaticResource ParamValueToBoolConverter}, ConverterParameter={x:Static selectionFilter:LinePointTypeFilteringMode.Tail}, Mode=TwoWay}" />
                    </StackPanel>
                    <CheckBox Margin="5" Content="Only match next nodes with a selected start node"
                              IsChecked="{Binding FilterOptions.OnlyMatchLanesWithSelectedStartNodes, Mode=TwoWay}" />
                    <CheckBox Margin="5" Content="Only match curve points with a selected lane node"
                              IsChecked="{Binding FilterOptions.OnlyMatchCurvesWithSelectedLaneNodes, Mode=TwoWay}" />
                </StackPanel>
            </TabItem>

            <TabItem Header="Hit">
                <StackPanel Orientation="Vertical">
                    <StackPanel Orientation="Horizontal" Margin="5 5">
                        <Label>Is Critical</Label>
                        <RadioButton GroupName="IsCriticalOptions"
                                     Content="Any"
                                     IsChecked="{Binding FilterOptions.IsCriticalFilterMode, Converter={StaticResource ParamValueToBoolConverter}, ConverterParameter={x:Static selectionFilter:YesNoFilteringMode.Any}, Mode=TwoWay}" />
                        <RadioButton GroupName="IsCriticalOptions"
                                     Content="Yes"
                                     IsChecked="{Binding FilterOptions.IsCriticalFilterMode, Converter={StaticResource ParamValueToBoolConverter}, ConverterParameter={x:Static selectionFilter:YesNoFilteringMode.Yes}, Mode=TwoWay}" />
                        <RadioButton GroupName="IsCriticalOptions"
                                     Content="No"
                                     IsChecked="{Binding FilterOptions.IsCriticalFilterMode, Converter={StaticResource ParamValueToBoolConverter}, ConverterParameter={x:Static selectionFilter:YesNoFilteringMode.No}, Mode=TwoWay}" />
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="5 5">
                        <Label>Flick Direction</Label>
                        <RadioButton GroupName="FlickDirectionRadio"
                                     Content="Any"
                                     IsChecked="{Binding FilterOptions.FlickDirectionFilteringMode, Converter={StaticResource ParamValueToBoolConverter}, ConverterParameter={x:Static selectionFilter:LeftRightFilteringMode.Any}, Mode=TwoWay}" />
                        <RadioButton GroupName="FlickDirectionRadio"
                                     Content="Left"
                                     IsChecked="{Binding FilterOptions.FlickDirectionFilteringMode, Converter={StaticResource ParamValueToBoolConverter}, ConverterParameter={x:Static selectionFilter:LeftRightFilteringMode.Left}, Mode=TwoWay}" />
                        <RadioButton GroupName="FlickDirectionRadio"
                                     Content="Right"
                                     IsChecked="{Binding FilterOptions.FlickDirectionFilteringMode, Converter={StaticResource ParamValueToBoolConverter}, ConverterParameter={x:Static selectionFilter:LeftRightFilteringMode.Right}, Mode=TwoWay}" />
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="5">
                        <Label Content="Hold object type" />
                        <RadioButton GroupName="HoldPartOptions"
                                     Content="Any"
                                     IsChecked="{Binding FilterOptions.HoldPartFilteringMode, Converter={StaticResource ParamValueToBoolConverter}, ConverterParameter={x:Static selectionFilter:LinePointTypeFilteringMode.Any}, Mode=TwoWay}" />
                        <RadioButton GroupName="HoldPartOptions"
                                     Content="Start"
                                     IsChecked="{Binding FilterOptions.HoldPartFilteringMode, Converter={StaticResource ParamValueToBoolConverter}, ConverterParameter={x:Static selectionFilter:LinePointTypeFilteringMode.Head}, Mode=TwoWay}" />
                        <RadioButton GroupName="HoldPartOptions"
                                     Content="End"
                                     IsChecked="{Binding FilterOptions.HoldPartFilteringMode, Converter={StaticResource ParamValueToBoolConverter}, ConverterParameter={x:Static selectionFilter:LinePointTypeFilteringMode.Tail}, Mode=TwoWay}" />
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="5">
                        <Label Content="Dock lanes" />
                        <xctk:CheckComboBox x:Name="FilterDockableTypeCheckComboBox" Width="100"
                                            IsSelectAllActive="True"
                                            ItemsSource="{Binding FilterOptions.FilterDockableLaneOptions}"
                                            DisplayMemberPath="Name" SelectedMemberPath="IsSelected"
                                            Text="" />
                    </StackPanel>

                    <CheckBox Content="Only match hold ends with a selected hold start" Margin="5"
                              IsChecked="{Binding FilterOptions.OnlyMatchHoldsEndsWithSelectedStartNodes, Mode=TwoWay}" />

                </StackPanel>
            </TabItem>

            <TabItem Header="Bullets">
                <StackPanel Orientation="Vertical">
                    <StackPanel Orientation="Horizontal" Margin="5">
                        <Label Content="Bullet palette" />
                        <xctk:CheckComboBox ItemsSource="{Binding FilterOptions.FilterBulletPalettesItems}"
                                            SelectedMemberPath="IsSelected"
                                            IsSelectAllActive="True"
                                            Width="100"
                                            MaxWidth="100"
                                            Loaded="BulletPaletteCheckList_SetText"
                                            Closed="BulletPaletteCheckList_SetText">
                            <xctk:CheckComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Display}" />
                                </DataTemplate>
                            </xctk:CheckComboBox.ItemTemplate>
                        </xctk:CheckComboBox>
                    </StackPanel>

                </StackPanel>
            </TabItem>
        </TabControl>

        <Separator />

        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="5">
            <CheckBox Content="Invert filter"
                      IsChecked="{Binding FilterOptions.FilterSelectionChangeMode, Converter={StaticResource ParamValueToBoolConverter}, ConverterParameter={x:Static selectionFilter:FilterMode.Remove}, Mode=TwoWay}" />
        </StackPanel>

        <TextBlock Text="{Binding FilterOutcomeText}">
        </TextBlock>

        <StackPanel Orientation="Horizontal">
            <Button Content="Apply" Click="ApplyButton_Click" />
            <Button Content="Cancel" Click="CancelButton_Click" />
        </StackPanel>
    </StackPanel>
</Window>